<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introductory distance sampling training materials – output</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://kit.fontawesome.com/78ddb093ea.js" crossorigin="anonymous"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Introductory distance sampling training materials</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://distancesampling.org" rel="" target="">
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../01-intro/introlanding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fundamentals of distance sampling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../01-intro/Mod1-2023-intro.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://youtu.be/_4RX6P4PB4k" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture video</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../01-intro/introlanding.html#exercise-materials" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise materials</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Detection function modelling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../02-detfns/detfnlanding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fitting detection functions to line transect data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Model criticism</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../03-criticism/criticismlanding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model criticism</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Precision of density estimates</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../04-precision/precisionlanding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Precision of density estimates</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Point transect analysis</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../05-points/pointslanding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis of point transect data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Design of distance sampling surveys</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../06-design/designlanding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Design of distance sampling surveys</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
 <span class="menu-text">Analysis of stratified designs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../07-stratify/stratifylanding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis of stratified surveys</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
 <span class="menu-text">Covariates in the detection functions</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../08-covariates/covariateslanding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Including covariates in detection function modelling</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<p><strong>Interpreting MRDS output: making sense of all the numbers</strong></p>
<p>ML Burt, CREEM, University of St Andrews (lb9@st-andrews.ac.uk)</p>
<p><strong>INTRODUCTION</strong></p>
<p>The mrds package (Laake <em>et al</em>. 2019) was written to allow the user to estimate abundance from a mark-recapture distance sampling (MRDS) survey (i.e.&nbsp;taking account of imperfect detection both on and away from the transect centreline). On running an analysis lots of output is generated and wading through all the numbers can be a bit daunting for a first-time user. This document aims to help the user understand the output and find key bits of information. Some knowledge of conventional distance sampling (see Buckland <em>et al</em>. 2001) and MRDS is assumed; for details on undertaking a MRDS analysis see Burt <em>et al</em>. (2014).</p>
<p>The mrds package can be used in R (R core Team 2019) directly or via program Distance for Windows v7 (Thomas <em>et al</em>. 2010). The same output is available on both software platforms but in Distance for Windows output is generated automatically to a ‘Results’ tab and in R the user is required to do a bit of work to obtain the information (e.g.&nbsp;using the summary and plot commands).</p>
<p>The example data used here is taken from a survey of faecal pellets (Jenkins and Manly 2008; Example 1 of Burt <em>et al.</em> 2014). The Distance for Windows project of these data is available to download from <a href="http://distancesampling.org/Distance/example-projects" class="uri">http://distancesampling.org/Distance/example-projects</a> (this will likely get moved to <a href="https://examples.distancesampling.org/" class="uri">https://examples.distancesampling.org/</a> at some point). The focus of this study was to estimate the probability of detection of pellet groups rather than estimating density or abundance of animals. Output from an analysis of these example data is annotated (in red text) in the following sections but first terms and quantities are defined.</p>
<p>This is a work in progress; comments and suggestions to improve the document are welcome.</p>
<p><strong>GLOSSARY</strong></p>
<p>Covered region Region covered during the survey i.e.&nbsp;2<em>wL</em>.</p>
<p>Study region Area of interest.</p>
<p>Detected object This could be a group (cluster) of objects and group size is recorded or individual objects if cluster size is one for all objects.</p>
<p>Observer One or more people performing the same role or could be an acoustic or digital observer.</p>
<p>Observer 1 Also known as the Primary observer in a trial configuration setup.</p>
<p>Observer 2 Also known as the Secondary observer in a trial configuration setup.</p>
<p>DS model Distance sampling model; fitted assuming <em>g</em>(0)=1 i.e.&nbsp;certain detection on the transect centreline. This could be a conventional distance sampling model (Buckland <em>et al</em>. 2001) or a multiple covariate distance sampling model (Marques and Buckland 2004).</p>
<p>MR model Mark-recapture model; logistic regression model <span class="math inline">\(p_{j|3 - j}\left( y,\underline{z} \right) = \frac{exp(\beta_{0} + \beta_{1}y + \sum_{k = 1}^{K}{\beta_{k + 1}z_{k})}}{1 + exp(\beta_{0} + \beta_{1}y + \sum_{k = 1}^{K}{\beta_{k + 1}z_{k})}}\)</span></p>
<blockquote class="blockquote">
<p>where <em>j</em> (<em>j</em>=1 or 2) is observer, the <em>β</em>’s are model coefficients, <em>y</em> is perpendicular distance and <em>z</em> are covariates.</p>
</blockquote>
<p>IO configuration Independent observer configuration; both observers search independently of the other observer. The probability of detection by either, or both, of the observers is of interest.</p>
<p>Trial configuration One observer (often called the primary) searches independently. A second observer (often called the tracker) searches for animals, beyond the search distance of the primary, and tracks them in order to determine more easily if the primary also detects them. The probability of detection of the primary observer is of interest.</p>
<p>Full independence Detections between observers are assumed to be independent at all perpendicular distances. This assumption requires only a MR model to be fitted.</p>
<p>Point independence Detections between observers are assumed to be independent only at the point where perpendicular distance is zero (i.e. on the transect centreline). This assumption requires both a DS and MR model to be fitted.</p>
<p><strong>NOTATION</strong></p>
<p><strong>Observed values</strong></p>
<p>n<sub>1</sub> total number of detected objects seen by observer 1 (also Primary observer)</p>
<p>n<sub>2</sub> total number of detected objects seen by observer 2 (also Secondary observer)</p>
<p>n<sub>D</sub> total number of detected objects seen by both observers (Duplicate detections)</p>
<p>n<sub>P</sub> = n<sub>1</sub>+n<sub>2</sub>-n<sub>D</sub> total number of detected objects (Pooled detections)</p>
<p>p<sub>1|2</sub> = n<sub>D</sub>/n<sub>2</sub> proportion detected by observer 1 of those seen by observer 2</p>
<p>p<sub>2|1</sub> = n<sub>D</sub>/n<sub>1</sub> proportion detected by observer 2 of those seen by observer 1</p>
<p><strong>Estimated values</strong></p>
<p>The estimated probabilities are the probabilities of detection for detected objects. The model used to estimate them is given in parentheses.</p>
<p><span class="math inline">\({\widehat{p}}_{j}(0)\)</span> (MR model) Estimate of probability of detection (of objects) on the trackline for observer <em>j</em> (<em>j</em>=1 or 2). If the MR model is of the form <span class="math inline">\({\widehat{p}}_{j|3 - j}(y) = \frac{exp({\widehat{\beta}}_{0} + {\widehat{\beta}}_{1}y)}{1 + exp({\widehat{\beta}}_{0} + {\widehat{\beta}}_{1}y)}\)</span> i.e.&nbsp;no covariates (except distance) then</p>
<p><span class="math inline">\({\widehat{p}}_{j|3 - j}(0) = \frac{exp({\widehat{\beta}}_{0})}{1 + exp({\widehat{\beta}}_{0})}\)</span>. Similar calculations hold if observer is included (with the coefficient for observer included) but if other covariates are included, then the function is averaged over all covariates and a more complicated formula is used (see Laake and Borchers 2004).</p>
<p><span class="math inline">\({\widehat{p}}_{P}(0)\)</span> (MR model) Estimate of probability of detection on the trackline (for both observers combined). When the MR model is simple (i.e.&nbsp;only contains covariates for distance (and/or observer in an IO configuration)), then <span class="math inline">\({\widehat{p}}_{P}(0) = {\widehat{p}}_{1}(0) + {\widehat{p}}_{2}(0) - {\widehat{p}}_{1}(0){\widehat{p}}_{2}(0)\)</span>. This equation does not hold when other covariates are included in the MR model; in this case, the intercept is obtained by averaging over all covariates (see Laake and Borchers 2004).</p>
<p><span class="math inline">\({\widehat{p}}_{P.DS}\)</span> (DS model) Estimate of probability of detection (over all distances) for both observers pooled</p>
<p><span class="math inline">\({\widehat{p}}_{1.DS}\)</span> (DS model) Estimate of probability of detection (over all distances) for observer 1</p>
<p><span class="math inline">\({\widehat{p}}_{P}\)</span> Estimate of probability of detection (over all distances) for both observers pooled taking into account imperfect detection on the trackline. Under the point independence assumption <span class="math inline">\({\widehat{p}}_{P} = \ {\widehat{p}}_{P}(0).{\widehat{p}}_{P.DS}\)</span></p>
<p><span class="math inline">\({\widehat{p}}_{1}\)</span> Estimate of probability of detection (over all distances) for observer 1 taking into imperfect account detection on the trackline. Under the point independence assumption <span class="math inline">\({\widehat{p}}_{1} = \ {\widehat{p}}_{1}(0){\widehat{p}}_{1.DS}\)</span></p>
<p><span class="math inline">\({\widehat{N}}_{cIO} = \frac{n_{P}}{\widehat{p}}\)</span> Estimated number of groups in the covered region for IO configuration</p>
<p><span class="math inline">\({\widehat{N}}_{cT} = \frac{n_{1}}{{\widehat{p}}_{1}}\)</span> Estimated number of groups in the covered region for Trial configuration</p>
<p><span class="math inline">\(\widehat{N}\)</span> Estimated number of individuals in the study region</p>
<p><span class="math inline">\({\widehat{N}}_{g}\)</span> Estimated number of groups, or clusters, in the study region</p>
<p><span class="math inline">\(E\left\lbrack \widehat{s} \right\rbrack = \frac{\widehat{N}}{{\widehat{N}}_{g}}\)</span> Expected group size</p>
<p><strong>OUTPUT FROM MRDS</strong></p>
<p>As mentioned previously, output in Distance for Windows goes to the Results tab. In R, the user needs to request model output using summary and plot commands. The exact information provided in the output will depend on the observer configuration and the independence assumption used. Here, we follow the order of the output used in Distance for Windows results tab.</p>
<p><strong>Summary of the observations</strong></p>
<p>The numbers of detected objects are tabulated and also plotted in histograms. The tabulated data in Distance for Windows is found on the Observation/Summary tab and the histograms are on the Observation/Plot tab. In R use det.tables(ddfmodel) to list these tables (for a fitted MRDS model called ddfmodel) and to plot the histograms use plot(det.tables(ddfmodel)).</p>
<p>The tabulated data consist of the numbers of objects detected in each perpendicular distance interval used for the histograms for observer 1, observer 2, pooled and duplicate detections. This information is useful because it illustrates the data that underpin the fitted models. Table 1 shows an example of tabulated data for three distance intervals (there are many more intervals in the actual data) and provides a summary of the key bits of information that can be found in these tables.</p>
<p>The data used for the histograms of the number of objects are described in Table 2a.</p>
<p><strong>Detection function summary</strong></p>
<p>In Distance for Windows, the detection function(s) is summarised on the Detection Fct/Summary tab: in R use summary(ddfmodel). The estimated coefficients of the fitted models are listed along with the probabilities of detection. The information included in the output depends on the configuration and independence assumption chosen:</p>
<ul>
<li><p>for an IO point independence model see Figure 1;</p></li>
<li><p>for an IO full independence model see Figure 2;</p></li>
<li><p>for a trial point independence model see Figure 3 and</p></li>
<li><p>for a trial full independence model see Figure 4.</p></li>
</ul>
<p>The detection function plots are described in Table 2b. In R use plot(ddfmodel). The intercepts of the fitted models are also given in Table 2a.</p>
<p><strong>Density and abundance estimates</strong></p>
<p>Density and abundance estimates (if requested) are found in Distance on the ‘Density Estimates and associated quantities’ tab. In R, data frames containing information on strata (region.data), transects (sample.data) and observations (obs.data) are required as input to obtain density and abundance estimates using the dht function i.e. dht(ddfmodel,region.data,sample.data,obs.data). These data link objects (detections) to transects and transects to survey regions and provide data on search effort and area of survey strata.</p>
<p>Summary data and estimates (density and abundance) are provided for groups (clusters) and individuals and also expected group size for each strata. In ‘Summary statistics’ (for either clusters or individuals) the number of objects (n) will depended on whether an IO configuration (n<sub>P</sub>) or a trial configuration (n<sub>1</sub>) is selected.</p>
<p><strong>REFERENCES</strong></p>
<p>Buckland ST, DR Anderson, KP Burnham. JL Laake, DL Borchers and L Thomas (2001) Introduction to Distance Sampling. Oxford University Press, Oxford, UK</p>
<p>Burt ML, DL Borchers, KJ Jenkins and TA Marques (2014) Using mark-recapture distance sampling methods on line transect surveys. Methods in Ecology and Evolution. doi: 10.1111/2041-210X.12294</p>
<p>Laake J, DL Borchers, L Thomas, D Miller and J Bishop (2019) mrds: Mark-Recapture Distance Sampling. R package version 2.2.1</p>
<p>Laake JL and DL Borchers (2004) Methods for incomplere detection at distance zero. Advanced Distance Sampling (eds) ST Buckland DR Anderson, KP Burnham. JL Laake, DL Borchers and L Thomas, Oxford University Press, Oxford, UK</p>
<p>Marques FFC and ST Buckland (2004) Covariates models for the detection function. Advanced Distance Sampling (eds) ST Buckland DR Anderson, KP Burnham. JL Laake, DL Borchers and L Thomas, Oxford University Press, Oxford, UK</p>
<p>R Core Team (2016). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.</p>
<p>Thomas L, ST Buckland, EA Rexstad, JL Laake, S Strindberg, SL Hedley, JRB Bishop, TA Marques and KP Burnham (2010)&nbsp;Distance software: design and analysis of <a href="mk:@MSITStore:C:\Program%20Files%20(x86)\Distance%207\Help\Distance.chm::/gloss_distancesampling.htm"><u>distance sampling</u></a> surveys for estimating population size.&nbsp; Journal of Applied Ecology 47: 5-14.&nbsp; DOI: 10.1111/j.1365-2664.2009.01737.x</p>
<p>Table 1 Observation summary tables: a) key information extracted from b) example output. The symbol ‘:’ indicates that there are more distance intervals in the actual data.</p>
<ol type="1">
<li>Summary of key information for three distance intervals and on which Results tab the information is found in Distance for Windows.</li>
</ol>
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Interval</th>
<th>n<sub>1</sub></th>
<th>n<sub>2</sub></th>
<th>n<sub>D</sub></th>
<th>n<sub>P</sub></th>
<th>p<sub>1|2</sub></th>
<th>p<sub>2|1</sub></th>
<th>Results tab</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[0, 5.17]</td>
<td>78</td>
<td>85</td>
<td>66</td>
<td>97</td>
<td>0.776</td>
<td>0.846</td>
<td>Observation/ Summary</td>
</tr>
<tr class="even">
<td>[5.17, 10.3]</td>
<td>40</td>
<td>42</td>
<td>30</td>
<td>52</td>
<td>0.714</td>
<td>0.750</td>
<td></td>
</tr>
<tr class="odd">
<td>[10.3, 15.5]</td>
<td>41</td>
<td>40</td>
<td>30</td>
<td>51</td>
<td>0.750</td>
<td>0.731</td>
<td></td>
</tr>
<tr class="even">
<td>:</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td>1094</td>
<td>1102</td>
<td>816</td>
<td>1380</td>
<td>0.740<sup>1</sup></td>
<td>0.745<sup>1</sup></td>
<td>Detection Fct/Summary</td>
</tr>
</tbody>
</table>
<p><sup>1</sup> Not given in Detection function summary – these are Petersen estimates</p>
<ol start="2" type="1">
<li>Example output</li>
</ol>
<p>Observer 1 detections</p>
<p>Detected</p>
<p>Missed Detected (n<sub>1</sub>)</p>
<p>[0,5.17] 19 78 (19 + 78 = 97 = n<sub>p</sub>)</p>
<p>(5.17,10.3] 12 40</p>
<p>(10.3,15.5] 10 41</p>
<p>:</p>
<p>Observer 2 detections</p>
<p>Detected</p>
<p>Missed Detected (n<sub>2</sub>)</p>
<p>[0,5.17] 12 85 (12 + 85 = 97 = n<sub>p</sub>)</p>
<p>(5.17,10.3] 10 42</p>
<p>(10.3,15.5] 11 40</p>
<p>:</p>
<p>Duplicate detections (n<sub>D</sub>)</p>
<p>[0,5.17] (5.17,10.3] (10.3,15.5] (15.5,20.7] (20.7,25.9] (25.9,31]</p>
<p>66 30 30 53 35 46</p>
<p>:</p>
<p>Pooled detections (n<sub>P</sub>)</p>
<p>[0,5.17] (5.17,10.3] (10.3,15.5] (15.5,20.7] (20.7,25.9] (25.9,31]</p>
<p>97 52 51 86 64 64</p>
<p>:</p>
<p>Observer 1 detections of those seen by Observer 2</p>
<p>Missed Detected Prop. Detected (p<sub>1|2</sub>)</p>
<p>[0,5.17] 19 66 0.7764706 (66/(19+66) = 66/85 = 0.7764)</p>
<p>(5.17,10.3] 12 30 0.7142857</p>
<p>(10.3,15.5] 10 30 0.7500000</p>
<p>:</p>
<p>Observer 2 detections of those seen by Observer 1</p>
<p>Missed Detected Prop. Detected (p<sub>2|1</sub>)</p>
<p>[0,5.17] 12 66 0.8461538 (66/(12+66)= 66/78 = 0.8461)</p>
<p>(5.17,10.3] 10 30 0.7500000</p>
<p>(10.3,15.5] 11 30 0.7317073</p>
<p>:</p>
<p>Table 2 Information plotted for each observer configuration (IO and Trial). A dash indicates that figure is not plotted for that observer configuration.</p>
<ol type="1">
<li>Observation/Plot tab</li>
</ol>
<table class="table">
<colgroup>
<col style="width: 19%">
<col style="width: 8%">
<col style="width: 20%">
<col style="width: 17%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Summary plot #</th>
<th></th>
<th>Histogram colour</th>
<th></th>
<th>Numbers of objects for who?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>IO</td>
<td>Trial</td>
<td>Black</td>
<td>Blue</td>
<td></td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td>n<sub>P</sub></td>
<td>n<sub>1</sub></td>
<td>Pooled and observer 1</td>
</tr>
<tr class="odd">
<td>2</td>
<td>2</td>
<td>n<sub>P</sub></td>
<td>n<sub>2</sub></td>
<td>Pooled and observer 2</td>
</tr>
<tr class="even">
<td>3</td>
<td>3</td>
<td>n<sub>D</sub></td>
<td></td>
<td>Duplicates</td>
</tr>
<tr class="odd">
<td>4</td>
<td>-</td>
<td>n<sub>P</sub></td>
<td></td>
<td>Pooled</td>
</tr>
<tr class="even">
<td>5</td>
<td>4</td>
<td>n<sub>2</sub></td>
<td>n<sub>D</sub></td>
<td>Observer 2 and duplicates</td>
</tr>
<tr class="odd">
<td>6</td>
<td>-</td>
<td>n<sub>1</sub></td>
<td>n<sub>D</sub></td>
<td>Observer 1 and duplicates</td>
</tr>
</tbody>
</table>
<ol start="2" type="1">
<li>Detection Function/Plot tab</li>
</ol>
<p>The points on the plots are estimated values for individual detections and the line is the average value (taking into account all covariates in the model).</p>

<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 22%">
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th colspan="2">
<p>
Detection probability
</p>
<p>
plot #
</p>
</th>
<th rowspan="2">
Histogram
</th>
<th colspan="2">
Which model used for independence assumption?
</th>
<th rowspan="2">
Intercept of the line is at?
</th>
</tr>
<tr class="odd">
<th>
IO
</th>
<th>
Trial
</th>
<th>
Point
</th>
<th>
Full
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>
1
</td>
<td>
1
</td>
<td>
Scaled n<sub>1</sub>
</td>
<td>
DS model
</td>
<td>
MR model
</td>
<td>
<span class="math display"><em>p̂</em><sub>1</sub>(0)</span>
</td>
</tr>
<tr class="even">
<td>
2
</td>
<td>
-
</td>
<td>
Scaled n<sub>2</sub>
</td>
<td>
DS model
</td>
<td>
MR model
</td>
<td>
<span class="math display"><em>p̂</em><sub>2</sub>(0)</span>
</td>
</tr>
<tr class="odd">
<td>
3
</td>
<td>
-
</td>
<td>
Scaled n<sub>P</sub>
</td>
<td>
DS model
</td>
<td>
MR model
</td>
<td>
<span class="math display"><em>p̂</em><sub><em>P</em></sub>(0)</span>
</td>
</tr>
<tr class="even">
<td>
4
</td>
<td>
-
</td>
<td>
Scaled n<sub>D</sub>
</td>
<td>
DS model
</td>
<td>
MR model
</td>
<td>
?
</td>
</tr>
<tr class="odd">
<td>
5
</td>
<td>
2
</td>
<td>
p<sub>1|2</sub>
</td>
<td>
MR model
</td>
<td>
MR model
</td>
<td>
<span class="math display"><em>p̂</em><sub>1</sub>(0)</span>
</td>
</tr>
<tr class="even">
<td>
6
</td>
<td>
-
</td>
<td>
p<sub>2|1</sub>
</td>
<td>
MR model
</td>
<td>
MR model
</td>
<td>
<span class="math display"><em>p̂</em><sub>2</sub>(0)</span>
</td>
</tr>
</tbody>

</table>
<p>Figure 1 Example detection function summary for an <strong>IO point independence</strong> model: MR model contains distance and a factor for observer (this is a Petersen model); the DS model uses a hazard rate form with no covariates (apart from distance).</p>
<p><strong>Summary for io.fi object</strong> (MR model)</p>
<p>Number of observations : 1380 n<sub>P</sub></p>
<p>Number seen by primary : 1094 n<sub>1</sub></p>
<p>Number seen by secondary : 1102 n<sub>2</sub></p>
<p>Number seen by both : 816 n<sub>D</sub></p>
<p>AIC : 2652.566</p>
<p>Conditional detection function parameters:</p>
<p>estimate se</p>
<p>(Intercept) 1.334518220 0.107556941</p>
<p>distance -0.004843781 0.001385673</p>
<p>observer2 0.028370866 0.084224532</p>
<p>Estimate SE CV</p>
<p>Average primary p(0) 0.7915870 0.017744426 0.02241627 <span class="math inline">\({\widehat{p}}_{1}(0)\)</span></p>
<p>Average secondary p(0) 0.7962288 0.017526680 0.02201211 <span class="math inline">\({\widehat{p}}_{2}(0)\)</span></p>
<p>Average combined p(0) 0.9575314 0.006690943 0.00698770 <span class="math inline">\({\widehat{p}}_{P}(0)\)</span></p>
<p><strong>Summary for ds object</strong> (DS model)</p>
<p>Number of observations : 1380 n<sub>P</sub></p>
<p>Distance range : 0 - 150</p>
<p>AIC : 13612.95</p>
<p>Detection function:</p>
<p>Hazard-rate key function</p>
<p>Detection function parameters</p>
<p>Scale coefficient(s):</p>
<p>estimate se</p>
<p>(Intercept) 4.425513 0.05855335</p>
<p>Shape coefficient(s):</p>
<p>estimate se</p>
<p>(Intercept) 0.6851006 0.1247415</p>
<p>Estimate SE CV</p>
<p>Average p 0.6924608 0.02190796 0.03163784 <span class="math inline">\({\widehat{p}}_{P.DS}\)</span></p>
<p><strong>Summary for io object</strong> (MR + DS model combined)</p>
<p>Total AIC value : 16255.2 = 2652.566 + 13612.95</p>
<p>Estimate SE CV</p>
<p>Average p 0.663053 0.02148313 0.03240032 <span class="math inline">\({\widehat{p}}_{P}\)</span></p>
<p>N in covered region 2081.281660 74.86672579 0.03597145 <span class="math inline">\({\widehat{N}}_{cIO}\)</span></p>
<p>Figure 2 Example detection function summary for an <strong>IO full independence</strong> model: MR model contains covariates distance and observer (as a factor).</p>
<p><strong>Summary for io.fi object</strong> (MR model)</p>
<p>Number of observations : 1380 n<sub>P</sub></p>
<p>Number seen by primary : 1094 n<sub>1</sub></p>
<p>Number seen by secondary : 1102 n<sub>2</sub></p>
<p>Number seen by both : 816 n<sub>D</sub></p>
<p>AIC : 16481.92</p>
<p>Conditional detection function parameters:</p>
<p>estimate se</p>
<p>(Intercept) 1.334518220 0.107556941</p>
<p>distance -0.004843781 0.001385673</p>
<p>observer2 0.028370866 0.084224532</p>
<p>Estimate SE CV</p>
<p>Average p 0.9233260 0.007189382 0.007786396 <span class="math inline">\({\widehat{p}}_{P}\)</span></p>
<p>Average primary p(0) 0.7915870 0.016272902 0.020557313 <span class="math inline">\({\widehat{p}}_{1}(0)\)</span></p>
<p>Average secondary p(0) 0.7962288 0.016064551 0.020175796 <span class="math inline">\({\widehat{p}}_{2}(0)\)</span></p>
<p>Average combined p(0) 0.9575314 0.005181690 0.005411509 <span class="math inline">\({\widehat{p}}_{P}(0)\)</span></p>
<p>N in covered region 1494.5966586 16.110394124 0.010779091 <span class="math inline">\({\widehat{N}}_{cIO}\)</span></p>
<p>Figure 3 Example detection function summary for a <strong>Trial point independence</strong> model: DS model uses a hazard rate form with no covariates in the scale parameter; MR model contains distance only.</p>
<p><strong>Summary for trial.fi object</strong> (MR model)</p>
<p>Number of observations : 1380 n<sub>P</sub></p>
<p>Number seen by primary : 1094 n<sub>1</sub></p>
<p>Number seen by secondary (trials) : 1102 n<sub>2</sub></p>
<p>Number seen by both (detected trials): 816 n<sub>D</sub></p>
<p>AIC : 1260.732</p>
<p>Conditional detection function parameters:</p>
<p>estimate se</p>
<p>(Intercept) 1.279522703 0.124363484</p>
<p>distance -0.003960919 0.001732436</p>
<p>Estimate SE CV</p>
<p>Average primary p(0) 0.7823685 0.02117513 0.02706542 <span class="math inline">\({\widehat{p}}_{1}(0)\)</span></p>
<p><strong>Summary for ds object</strong> (DS model)</p>
<p>Number of observations : 1094 n<sub>1</sub></p>
<p>Distance range : 0 - 150</p>
<p>AIC : 10770.29</p>
<p>Detection function:</p>
<p>Hazard-rate key function</p>
<p>Detection function parameters</p>
<p>Scale coefficient(s):</p>
<p>estimate se</p>
<p>(Intercept) 4.442346 0.05685968</p>
<p>Shape coefficient(s):</p>
<p>estimate se</p>
<p>(Intercept) 0.8301251 0.133593</p>
<p>Estimate SE CV</p>
<p>Average p 0.6936849 0.02237827 0.03226 <span class="math inline">\({\widehat{p}}_{1.DS}\)</span></p>
<p><strong>Summary for trial object</strong> (MR + DS model combined)</p>
<p>Total AIC value = 12031.02 = 10770.29 + 1260.73</p>
<p>Estimate SE CV</p>
<p>Average p 0.5427173 0.02285377 0.04210991 <span class="math inline">\({\widehat{p}}_{1}\)</span></p>
<p>N in covered region 2015.7825642 94.36006632 0.04681064 <span class="math inline">\({\widehat{N}}_{cT}\)</span></p>
<p>Figure 4 Example detection function summary for a <strong>Trial full independence</strong> model: MR model contains distance only.</p>
<p><strong>Summary for trial.fi object</strong> (MR model)</p>
<p>Number of observations : 1380 n<sub>P</sub></p>
<p>Number seen by primary : 1094 n<sub>1</sub></p>
<p>Number seen by secondary (trials) : 1102 n<sub>2</sub></p>
<p>Number seen by both (detected trials): 816 n<sub>D</sub></p>
<p>AIC : 12185.06</p>
<p>Conditional detection function parameters:</p>
<p>estimate se</p>
<p>(Intercept) 1.279522703 0.124363484</p>
<p>distance -0.003960919 0.001732436</p>
<p>Estimate SE CV</p>
<p>Average p 0.7262759 0.01521478 0.02094904 <span class="math inline">\({\widehat{p}}_{1}\)</span></p>
<p>Average primary p(0) 0.7823685 0.01621225 0.02072201 <span class="math inline">\({\widehat{p}}_{1}(0)\)</span></p>
<p>N in covered region 1506.3146420 39.23133973 0.02604458 <span class="math inline">\({\widehat{N}}_{cT}\)</span></p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Centre for Research into Ecological and Environmental Modelling</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">University of St Andrews</div>
  </div>
</footer>



</body></html>